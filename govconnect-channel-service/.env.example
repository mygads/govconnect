# ==================== CHANNEL SERVICE ====================
#
# ENVIRONMENT MODES:
# ┌──────────────────────────────────────────────────────────────────────────┐
# │  MODE              │ SERVICE_URL PATTERN         │ DATABASE HOST         │
# ├──────────────────────────────────────────────────────────────────────────┤
# │  Local Dev (npm)   │ http://localhost:PORT       │ localhost:5432        │
# │  Docker Compose    │ http://service-name:PORT    │ postgres:5432         │
# │  Docker Swarm      │ http://service-name:PORT    │ postgres:5432         │
# └──────────────────────────────────────────────────────────────────────────┘
#
# This service handles:
# - WhatsApp webhook (receive messages)
# - Message storage (FIFO 30 messages per user)
# - Internal API for sending messages
# - Chat history API for AI context
# ============================================================================

# Node Environment
NODE_ENV=development
PORT=3001

# Database (Channel Service)
# Local Dev: localhost:5432
# Docker: infra-postgres:5432
DATABASE_URL=postgresql://postgres:genfity2025@infra-postgres:5432/gc_channel

# RabbitMQ
# Local Dev: localhost:5672
# Docker: rabbitmq:5672
RABBITMQ_URL=amqp://admin:genfityrabbitmq@rabbitmq:5672/govconnect

# Internal API Key (untuk auth antar service)
INTERNAL_API_KEY=govconnect-internal-2025-secret

# WhatsApp API (clivy-wa-support/genfity-wa)
# WA_API_URL is the base URL of clivy-wa-support gateway
# WA_ACCESS_TOKEN is the session token from genfity-wa
WA_API_URL=https://api-wa.genfity.com
WA_ACCESS_TOKEN=your_session_token_here
WA_WEBHOOK_VERIFY_TOKEN=govconnect_verify_token_2025

# Message Batching
# Batch messages from same user to reduce AI calls
MESSAGE_BATCH_DELAY_MS=2000
MAX_BATCH_SIZE=10

# Logging
LOG_LEVEL=debug
LOG_DIR=logs

# ==================== INTERNAL SERVICE URLS ====================
# These are for internal service-to-service communication
# In Docker (Compose/Swarm): Use container names
# In Local Dev: Use localhost with respective ports
#
# ┌─────────────────────────────────────────────────────────────────────────────┐
# │  LOCAL DEVELOPMENT (npm run dev)                                            │
# │  ─────────────────────────────────────────────────────────────────────────  │
# │  CASE_SERVICE_URL=http://localhost:3003                                     │
# │  NOTIFICATION_SERVICE_URL=http://localhost:3004                             │
# ├─────────────────────────────────────────────────────────────────────────────┤
# │  DOCKER (Compose/Swarm) - Uses internal Docker network                      │
# │  ─────────────────────────────────────────────────────────────────────────  │
# │  CASE_SERVICE_URL=http://case-service:3003                                  │
# │  NOTIFICATION_SERVICE_URL=http://notification-service:3004                  │
# └─────────────────────────────────────────────────────────────────────────────┘
#
CASE_SERVICE_URL=http://localhost:3003
NOTIFICATION_SERVICE_URL=http://localhost:3004
