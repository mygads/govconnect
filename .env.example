# ===================================================================================
# GOVCONNECT - ENVIRONMENT CONFIGURATION
# ===================================================================================
#
# USAGE:
#   1. Copy this file: cp .env.example .env
#   2. Fill in your values
#   3. NEVER commit .env to git!
#
# FOR PRODUCTION:
#   - Change all passwords and secrets
#   - Set NODE_ENV=production
#   - Use secure URLs (https)
#
# ARCHITECTURE NOTE:
# ┌───────────────────────────────────────────────────────────────────────────────┐
# │  SERVICE COMMUNICATION PATTERNS                                               │
# │                                                                               │
# │  EXTERNAL ACCESS (Browser/Mobile/3rd Party):                                  │
# │  → https://api.govconnect.my.id/api/* (via Traefik)                          │
# │                                                                               │
# │  INTERNAL SERVICE-TO-SERVICE (Docker Network):                                │
# │  → http://service-name:port (direct, no Traefik)                             │
# │                                                                               │
# │  WHY? Internal calls don't need SSL overhead & are faster via Docker DNS     │
# └───────────────────────────────────────────────────────────────────────────────┘
#
# ===================================================================================

# ==================== ENVIRONMENT ====================
NODE_ENV=development
# NODE_ENV=production

# ==================== DATABASE (PostgreSQL) ====================
# Single database with schemas: channel, cases, notification, dashboard
# Port 5433 for Windows (avoid conflict), 5432 for Docker/Linux
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres_secret_2025
POSTGRES_PORT=5433

# Connection URLs (auto-configured in docker-compose, set for local dev)
DATABASE_URL=postgresql://postgres:postgres_secret_2025@localhost:5433/govconnect

# ==================== RABBITMQ ====================
RABBITMQ_USER=admin
RABBITMQ_PASSWORD=rabbitmq_secret_2025
# Management UI: http://localhost:15672

# ==================== SECURITY ====================
# Internal API Key (shared between all services)
# Generate: openssl rand -base64 32
INTERNAL_API_KEY=govconnect-internal-2025-secret

# JWT Secret for Dashboard authentication
# Generate: openssl rand -base64 32
JWT_SECRET=govconnect-jwt-secret-2025-change-in-production

# ==================== WHATSAPP API ====================
# Using clivy-wa-support / genfity-wa gateway
WA_API_URL=https://api-wa.genfity.com/wa
WA_ACCESS_TOKEN=your_session_token_here
WA_WEBHOOK_VERIFY_TOKEN=govconnect_verify_token_2025

# ==================== AI / LLM ====================
# Google Gemini (get key from: https://aistudio.google.com/apikey)
GEMINI_API_KEY=your_gemini_api_key_here

# LLM Settings (model selection via Dashboard)
LLM_TEMPERATURE=0.3
LLM_MAX_TOKENS=2000
LLM_TIMEOUT_MS=30000
MAX_HISTORY_MESSAGES=30

# ==================== MESSAGE BATCHING ====================
# Batch messages from same user to reduce AI calls
# Timer resets each time a new message arrives
MESSAGE_BATCH_DELAY_MS=5000
MAX_BATCH_SIZE=10

# ==================== RATE LIMITING ====================
RATE_LIMIT_ENABLED=true
MAX_REPORTS_PER_DAY=5
COOLDOWN_SECONDS=30
AUTO_BLACKLIST_VIOLATIONS=10

# ==================== LOGGING ====================
LOG_LEVEL=info
# LOG_LEVEL=debug

# ==================== MONITORING (Optional) ====================
# Only needed if using --profile monitoring
GRAFANA_USER=admin
GRAFANA_PASSWORD=govconnect-grafana-2025

# ==================== PRODUCTION DOMAIN ====================
# Only needed for production deployment
# DOMAIN=govconnect.my.id
# API_DOMAIN=api.govconnect.my.id
# ACME_EMAIL=admin@govconnect.my.id
# MEDIA_PUBLIC_URL=https://govconnect.my.id/uploads
