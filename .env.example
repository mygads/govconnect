# ===================================================================================
# GOVCONNECT - ENVIRONMENT CONFIGURATION
# ===================================================================================
#
# USAGE:
#   cp .env.example .env
#   # Edit values according to your environment
#
# DOCKER COMPOSE FILES:
#   - docker-compose.yml        = Local development (builds from source)
#   - docker-compose.swarm.yml  = Production on server (uses GHCR images)
#
# ARCHITECTURE NOTE:
# ┌───────────────────────────────────────────────────────────────────────────────┐
# │  SERVICE COMMUNICATION PATTERNS                                               │
# │                                                                               │
# │  EXTERNAL ACCESS (Browser/Mobile/3rd Party):                                  │
# │  → https://api.govconnect.my.id/api/* (via Traefik)                          │
# │                                                                               │
# │  INTERNAL SERVICE-TO-SERVICE (Docker Network):                                │
# │  → http://service-name:port (direct, no Traefik)                             │
# │                                                                               │
# │  WHY? Internal calls don't need SSL overhead & are faster via Docker DNS     │
# └───────────────────────────────────────────────────────────────────────────────┘
#
# ===================================================================================

# ==================== ENVIRONMENT ====================
NODE_ENV=production
LOG_LEVEL=info

# ==================== IMAGE TAG (for Swarm only) ====================
IMAGE_TAG=latest

# ==================== DATABASE (PostgreSQL) ====================
# Database is in containers/database/ (external)
# Each service uses separate database: gc_channel, gc_case, gc_notification, gc_dashboard
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_postgres_password
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# ==================== RABBITMQ ====================
# RabbitMQ is in containers/supporting/ (external)
RABBITMQ_USER=admin
RABBITMQ_PASSWORD=your_rabbitmq_password

# ==================== SECURITY ====================
# Generate secrets: openssl rand -base64 32
INTERNAL_API_KEY=your_internal_api_key
JWT_SECRET=your_jwt_secret
NEXTAUTH_SECRET=your_nextauth_secret

# ==================== WHATSAPP API ====================
# WhatsApp API is in containers/whatsapp-api/ (external)
WA_API_URL=http://wa-api:8080/wa
WA_ACCESS_TOKEN=your_wa_token
WA_WEBHOOK_VERIFY_TOKEN=your_webhook_verify_token

# ==================== AI / LLM ====================
# Get key from: https://aistudio.google.com/apikey
GEMINI_API_KEY=your_gemini_api_key
LLM_TEMPERATURE=0.3
LLM_MAX_TOKENS=2000
LLM_TIMEOUT_MS=30000
MAX_HISTORY_MESSAGES=30

# ==================== MESSAGE BATCHING ====================
# Batch messages from same user to reduce AI calls
MESSAGE_BATCH_DELAY_MS=2000
MAX_BATCH_SIZE=10

# ==================== RATE LIMITING ====================
RATE_LIMIT_ENABLED=true
MAX_REPORTS_PER_DAY=5
COOLDOWN_SECONDS=30
AUTO_BLACKLIST_VIOLATIONS=10

# ==================== URLS ====================
MEDIA_PUBLIC_URL=https://api.govconnect.my.id/channel/uploads
NEXTAUTH_URL=https://dashboard.govconnect.my.id
